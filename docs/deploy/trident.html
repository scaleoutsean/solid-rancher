<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <script data-goatcounter="https://ers3x2m6spekxd.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script> <link rel="shortcut icon" href="/solid-rancher/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/solid-rancher/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/solid-rancher/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/solid-rancher/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>NetApp Trident | Solid Rancher</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="NetApp Trident" /> <meta name="author" content="scaleoutSean" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Notes on rock-solid K8s clusters with Rancher &amp; NetApp HCI/SolidFire" /> <meta property="og:description" content="Notes on rock-solid K8s clusters with Rancher &amp; NetApp HCI/SolidFire" /> <link rel="canonical" href="https://scaleoutsean.github.io/solid-rancher/deploy/trident.html" /> <meta property="og:url" content="https://scaleoutsean.github.io/solid-rancher/deploy/trident.html" /> <meta property="og:site_name" content="Solid Rancher" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="NetApp Trident" /> <script type="application/ld+json"> {"description":"Notes on rock-solid K8s clusters with Rancher &amp; NetApp HCI/SolidFire","@type":"WebPage","headline":"NetApp Trident","url":"https://scaleoutsean.github.io/solid-rancher/deploy/trident.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://scaleoutsean.github.io/solid-rancher/assets/images/logo.png"},"name":"scaleoutSean"},"author":{"@type":"Person","name":"scaleoutSean"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://scaleoutsean.github.io/solid-rancher/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://scaleoutsean.github.io/solid-rancher/plan" class="nav-list-link">Plan</a><ul class="nav-list "><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/plan/network.html" class="nav-list-link">Network</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/plan/storage.html" class="nav-list-link">Storage</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/plan/vcenter.html" class="nav-list-link">vCenter and Other Accounts</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/plan/hcc-vs-ez-rancher.html" class="nav-list-link">HCC or ez-rancher</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://scaleoutsean.github.io/solid-rancher/deploy" class="nav-list-link">Deploy</a><ul class="nav-list "><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/deploy/ez-rancher.html" class="nav-list-link">ez-rancher</a></li><li class="nav-list-item active"><a href="https://scaleoutsean.github.io/solid-rancher/deploy/trident.html" class="nav-list-link active">NetApp Trident</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/deploy/infra.html" class="nav-list-link">Other Resources</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://scaleoutsean.github.io/solid-rancher/protect" class="nav-list-link">Protect</a><ul class="nav-list "><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/protect/protect-k8s-config.html" class="nav-list-link">Protect Kubernetes Configuration</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/protect/protect-solidfire-data.html" class="nav-list-link">Protect Data on SolidFire Storage</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://scaleoutsean.github.io/solid-rancher/automate/" class="nav-list-link">Automate</a><ul class="nav-list "><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/automate/automate-deployment.html" class="nav-list-link">Automate Deployment</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/automate/automate-operations.html" class="nav-list-link">Automate and Monitor Operations</a></li></ul></li><li class="nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> <p>Build: 2020-12-24 18:07+0800</p> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Solid Rancher" aria-label="Search Solid Rancher" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/deploy">Deploy</a></li> <li class="breadcrumb-nav-list-item"><span>NetApp Trident</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h3 id="hcc-catalog-helm-chart-vs-classic-approach-to-trident-deployment"> <a href="#hcc-catalog-helm-chart-vs-classic-approach-to-trident-deployment" class="anchor-heading" aria-labelledby="hcc-catalog-helm-chart-vs-classic-approach-to-trident-deployment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HCC Catalog (Helm Chart) vs. “Classic” Approach to Trident deployment </h3> <p>On NetApp HCI, use whatever the official documentation suggests (likely the Helm Chart (Catalog) approach).</p> <p>SolidFire and eSDS users can use either approach.</p> <ul> <li>Catalog approach <ul> <li>Standardized for Rancher with both NetApp HCI and SolidFire</li> <li>Good for frequent or repetitive deployments</li> <li>Not all Trident versions may be available but versions recommended by NetApp HCI for use with Rancher should be available</li> <li>Well-tested updates with documented update procedures specific to NetApp HCI</li> </ul> </li> <li>Classic approach <ul> <li>You can choose to deploy any Trident version (which can be both good and bad; at the very least you should check which Trident version is supported by NetApp HCC - this information could be found in the Trident documentation or by checking the versions deployed by ez-rancher Trident Catalog). In theory at least any Trident version that supports Kubernetes contained in a Rancher version supported by NetApp HCC should be acceptable. But if you want to be on the safe side, check what versions are supported by NetApp HCC with Rancher and use one of those.</li> <li>Somewhat manual process that can be automated, but also a source of problems if poorly planned and executed</li> <li>Uses standard update procedures from NetApp Trident</li> </ul> </li> </ul> <p><strong>NOTES</strong>:</p> <ul> <li>If you deploy multiple Rancher clusters against the same NetApp HCI or SolidFire back-end you must ensure that each Rancher cluster (and its Trident instance) use a different storage account so that CHAP authentication does not lead to one Rancher cluster seeing PVs from another</li> <li>When you destroy a cluster, remember to clean up the account, volumes, IQNs, VLANs, etc if you have no intent to use them again</li> <li>When assigning storage account names, assuming Rancher cluster have unique names, administrators could base SolidFire storage account names used by Trident upon Rancher cluster names</li> </ul> <h3 id="netapp-hcc-helm-chart-for-workload-clusters"> <a href="#netapp-hcc-helm-chart-for-workload-clusters" class="anchor-heading" aria-labelledby="netapp-hcc-helm-chart-for-workload-clusters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NetApp HCC Helm Chart for Workload Clusters </h3> <p>NetApp HCC users should be able to deploy it more easily.</p> <p>ez-rancher users can deploy it or add it later. Find it <a href="https://github.com/NetApp/ez-rancher-trident-installer">here</a>. Add this Helm Chart v3 to a User Cluster’s Catalog and deploy from the User Cluster’s Cluster Explorer (find it under Apps).</p> <h3 id="netapp-trident-classic"> <a href="#netapp-trident-classic" class="anchor-heading" aria-labelledby="netapp-trident-classic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NetApp Trident “Classic” </h3> <p>This approach uses standard NetApp Trident deployment steps as documented <a href="https://netapp-trident.readthedocs.io/">here</a>.</p> <p>A YouTube video of the process with Rancher v2.5.2 and Trident v20.10 can be viewed <a href="https://www.youtube.com/watch?v=pQbt_TzFqw">here</a>.</p> <h4 id="customize-trident-deployment-for-workload-clusters"> <a href="#customize-trident-deployment-for-workload-clusters" class="anchor-heading" aria-labelledby="customize-trident-deployment-for-workload-clusters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Customize Trident Deployment for Workload Clusters </h4> <ul> <li>In Trident back-end configuration file, pick a unique (not <code class="language-plaintext highlighter-rouge">trident</code>) user name for the Trident account for each individual cluster</li> <li>On SolidFire array, use the same name or other appropriate convention to “link” cluster name with Trident name</li> <li>For example Rancher cluster <code class="language-plaintext highlighter-rouge">rancher-dc1-az1-mfg-uc01</code> would use the same account name on SolidFire:</li> </ul> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"storageDriverName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"solidfire-san"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Endpoint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://admin:nimda@192.168.1.1/json-rpc/11.0"</span><span class="p">,</span><span class="w">
</span><span class="err">...</span><span class="w">
    </span><span class="nl">"TenantName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rancher-dc1-az1-mfg-uc01"</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div> <h4 id="configure-trident-qos-policies-with-non-overlapping-min-max-ranges"> <a href="#configure-trident-qos-policies-with-non-overlapping-min-max-ranges" class="anchor-heading" aria-labelledby="configure-trident-qos-policies-with-non-overlapping-min-max-ranges"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configure Trident QoS policies with non-overlapping Min-Max ranges </h4> <p>As long as <a href="https://github.com/NetApp/trident/issues/281">this</a> issue is open, it’s best to create Trident storage policies with non-overlaping Min-Max ranges unlike in this example:</p> <ul> <li>Slow: 200/2000/5000</li> <li>Fast: 500/5000/10000</li> </ul> <p>This should work better:</p> <ul> <li>Slow: 200/1000/5000</li> <li>Fast: 2000/5000/10000</li> </ul> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
