<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="/solid-rancher/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/solid-rancher/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/solid-rancher/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/solid-rancher/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Network | Solid Rancher</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="Network" /> <meta name="author" content="scaleoutSean" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Notes on rock-solid K8s clusters with Rancher &amp; NetApp HCI/SolidFire" /> <meta property="og:description" content="Notes on rock-solid K8s clusters with Rancher &amp; NetApp HCI/SolidFire" /> <link rel="canonical" href="https://scaleoutsean.github.io/solid-rancher/plan/network.html" /> <meta property="og:url" content="https://scaleoutsean.github.io/solid-rancher/plan/network.html" /> <meta property="og:site_name" content="Solid Rancher" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Network" /> <script type="application/ld+json"> {"description":"Notes on rock-solid K8s clusters with Rancher &amp; NetApp HCI/SolidFire","@type":"WebPage","headline":"Network","url":"https://scaleoutsean.github.io/solid-rancher/plan/network.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://scaleoutsean.github.io/solid-rancher/assets/images/logo.png"},"name":"scaleoutSean"},"author":{"@type":"Person","name":"scaleoutSean"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://scaleoutsean.github.io/solid-rancher/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/" class="nav-list-link">Home</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://scaleoutsean.github.io/solid-rancher/plan" class="nav-list-link">Plan</a><ul class="nav-list "><li class="nav-list-item active"><a href="https://scaleoutsean.github.io/solid-rancher/plan/network.html" class="nav-list-link active">Network</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/plan/storage.html" class="nav-list-link">Storage</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/plan/vcenter.html" class="nav-list-link">vCenter and Other Accounts</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/plan/hcc-vs-ez-rancher.html" class="nav-list-link">HCC or ez-rancher</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://scaleoutsean.github.io/solid-rancher/deploy" class="nav-list-link">Deploy</a><ul class="nav-list "><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/deploy/ez-rancher.html" class="nav-list-link">ez-rancher</a></li><li class="nav-list-item "><a href="https://scaleoutsean.github.io/solid-rancher/deploy/trident.html" class="nav-list-link">NetApp Trident</a></li></ul></li><li class="nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/protect" class="nav-list-link">Protect</a></li><li class="nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/automate/" class="nav-list-link">Automate</a></li><li class="nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> The source of this Web site is available in the Github repo. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Solid Rancher" aria-label="Search Solid Rancher" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://scaleoutsean.github.io/solid-rancher/plan">Plan</a></li> <li class="breadcrumb-nav-list-item"><span>Network</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h2 id="default-networks-on-netapp-hci"> <a href="#default-networks-on-netapp-hci" class="anchor-heading" aria-labelledby="default-networks-on-netapp-hci"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Default Networks on NetApp HCI </h2> <h3 id="with-vmware-vds"> <a href="#with-vmware-vds" class="anchor-heading" aria-labelledby="with-vmware-vds"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> With VMware vDS </h3> <p>These are created by NDE during deployment and should not be touched:</p> <ul> <li>DVS_HCI_internal_mNode_Network</li> <li>DVS_HCI_internal_Storage_Network</li> <li>DVS_HCI_internal_vCenter_Network</li> <li>DVS_HCI_vMotion</li> <li>DVS_HCI_ISCSI_A</li> <li>DVS_HCI_ISCSI_B</li> </ul> <p>NetApp HCI has <a href="https://docs.netapp.com/us-en/hci-solutions/">solution designs</a> for VMware Private Cloud and other Kubenetes distributions which contain examples of network design for Kubernetes on NetApp HCI.</p> <h2 id="rancher-management-cluster"> <a href="#rancher-management-cluster" class="anchor-heading" aria-labelledby="rancher-management-cluster"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rancher Management Cluster </h2> <p>This cluster must be able to communicate with at least the first three destinations in the list below:</p> <ul> <li>vCenter of the VMware cluster in which it is installed</li> <li>NetApp HCI Management Node (HCC services)</li> <li>All Rancher Workload Clusters it manages (each may have a separate Management VLAN, but they could also have common Kubernetes Cluster Management VLAN)</li> <li>NetApp HCI Storage Management IP (i.e. SolidFire MVIP, if NetApp Trident is used for storage provisioning) <ul> <li>Also any other storage Management IP involved (ONTAP SVM Management IP, etc.)</li> </ul> </li> <li>It may also need to be able to connect to a backup network, another cluster at the DR site, a gateway to connect to your Public Cloud provider, and so on</li> </ul> <h2 id="rancher-workload-clusters"> <a href="#rancher-workload-clusters" class="anchor-heading" aria-labelledby="rancher-workload-clusters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rancher Workload Cluster(s) </h2> <p>These need to be able to communicate with:</p> <ul> <li>The Rancher Management Cluster that manages it</li> <li>Storage Network (Worker Nodes only, and only if these use iSCSI or NFS storage provisioned by NetApp Trident) <ul> <li>NFS could be ONTAP Select running on VMware or any ONTAP appliance reachable from Worker NodesA)</li> <li>iSCSI could be NetApp HCI storage, NetApp E-Series (iSCSI), ONTAP (iSCSI)</li> </ul> </li> </ul> <p>Optionally these also may need to connect to other networks.</p> <h2 id="dns-ntp"> <a href="#dns-ntp" class="anchor-heading" aria-labelledby="dns-ntp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DNS, NTP </h2> <p>As usual: make sure vSphere, HCC/mNode and Rancher requirements are satisfied.</p> <h2 id="kubernetes-networking-options-with-rancher"> <a href="#kubernetes-networking-options-with-rancher" class="anchor-heading" aria-labelledby="kubernetes-networking-options-with-rancher"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kubernetes Networking Options with Rancher </h2> <ul> <li>Flannel</li> <li>Calico</li> <li>Canal (Network Isolation Available) - default</li> <li>Weave</li> </ul> <p>The last three offer the option of modifying MTU (CNI Plugin MTU Override). If your vSphere workload networks use MTU 9000, you can look into whether using non-default values helps you.</p> <p>NetApp HCI enforces MTU 9000 on iSCSI networks while other networks can use MTU 1500. Rancher Worker VMs may use MTU 9000 on the networks for iSCSI, but they can also work with iSCSI interfaces set to VM defaults (MTU 1500, for example). Other interfaces may not be able to use jumbo frames if vSphere networking does not support them.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
